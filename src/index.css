@tailwind base;
@tailwind components;
@tailwind utilities;

:root,
html.light {
  --background: 245 247 252;
  --foreground: 21 26 48;
  --card: 255 255 255;
  --border: 215 223 237;
  --muted: 94 106 133;
  --primary: 38 82 255;
  --success: 20 137 95;
  --danger: 198 48 48;
  --sidebar: 255 255 255;
  --sidebar-foreground: 21 26 48;
  --sidebar-muted: 94 106 133;
  --sidebar-active: 215 223 237;

  font-family: 'Manrope', 'DM Sans', 'Segoe UI', -apple-system, BlinkMacSystemFont, sans-serif;
}

html.dark {
  --background: 9 13 24;
  --foreground: 227 233 248;
  --card: 17 24 39;
  --border: 51 64 96;
  --muted: 148 161 190;
  --primary: 104 143 255;
  --success: 83 209 151;
  --danger: 242 121 121;
  --sidebar: 7 10 19;
  --sidebar-foreground: 233 239 255;
  --sidebar-muted: 138 154 193;
  --sidebar-active: 35 50 83;
}

* {
  box-sizing: border-box;
}

html,
body,
#root {
  min-height: 100%;
}

body {
  @apply m-0 bg-background text-foreground antialiased;
  background-image:
    radial-gradient(circle at 10% 10%, rgb(var(--primary) / 0.09), transparent 42%),
    radial-gradient(circle at 90% 0%, rgb(var(--success) / 0.08), transparent 30%),
    linear-gradient(180deg, rgb(var(--background)) 0%, rgb(var(--background) / 0.96) 100%);
}

a {
  color: inherit;
  text-decoration: none;
}

.app-shell {
  @apply grid min-h-screen grid-cols-[280px_1fr];
}

.sidebar {
  @apply sticky top-0 flex h-screen flex-col border-r border-sidebarActive/60 bg-sidebar px-5 py-6 text-sidebarForeground;
}

html.light .sidebar {
  @apply border-border/80 bg-card text-foreground;
}

.sidebar h1 {
  @apply mb-1 text-xl font-extrabold tracking-tight;
}

.sidebar nav {
  @apply mt-6 grid gap-1.5;
}

.sidebar a {
  @apply rounded-xl px-3 py-2.5 text-sm font-medium text-sidebarMuted transition-all duration-200;
}

.sidebar a:hover {
  @apply bg-sidebarActive/70 text-sidebarForeground;
}

.sidebar a.active {
  @apply bg-sidebarActive text-sidebarForeground shadow-[0_8px_24px_rgba(0,0,0,0.2)];
}

html.light .sidebar a {
  @apply text-muted;
}

html.light .sidebar a:hover {
  @apply bg-foreground/5 text-foreground;
}

html.light .sidebar a.active {
  @apply bg-foreground/10 text-foreground shadow-[0_8px_20px_rgba(17,24,39,0.08)];
}

html.dark .sidebar a.active {
  @apply shadow-[0_8px_24px_rgba(0,0,0,0.2)];
}

.main {
  @apply px-5 py-6 lg:px-8;
}

.topbar {
  @apply relative z-[70] mb-6 flex items-center justify-between gap-3 rounded-2xl border border-border/80 bg-card/70 px-4 py-3 shadow-[0_10px_24px_rgba(12,16,28,0.06)] backdrop-blur;
}

.topbar span {
  @apply block text-sm text-muted;
}

.topbar-leading {
  @apply flex items-center gap-2;
}

.topbar-actions {
  @apply relative z-[71] flex items-center gap-2;
}

.mobile-nav-toggle {
  @apply hidden;
}

.topbar-segment {
  @apply inline-flex items-center gap-2 rounded-2xl border border-border/80 bg-background/65 p-1.5 shadow-[0_8px_20px_rgba(9,14,25,0.08)] backdrop-blur;
}

.topbar-control-wrap {
  @apply relative z-[80];
}

.topbar-icon-button {
  @apply inline-flex h-9 items-center gap-2 rounded-xl border border-border/80 bg-card/80 px-2.5 text-xs font-semibold text-foreground transition-all duration-200 hover:border-foreground/30 hover:bg-card focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary/70;
}

.topbar-icon-button svg {
  @apply h-4 w-4 text-muted;
}

.topbar-icon-value {
  @apply max-w-[90px] truncate text-[11px] font-semibold tracking-[0.02em];
}

.topbar-dropdown {
  @apply min-w-[140px] rounded-xl border border-border/80 bg-card/95 p-1.5 shadow-[0_16px_34px_rgba(10,18,35,0.2)] backdrop-blur;
}

.topbar-dropdown-portal {
  @apply fixed z-[220] mt-0;
}

.topbar-dropdown-item {
  @apply block w-full rounded-lg px-2.5 py-1.5 text-left text-xs font-medium text-foreground transition-colors duration-150 hover:bg-foreground/5 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary/70;
}

.topbar-dropdown-item.is-active {
  color: rgb(var(--primary));
  background: rgb(var(--primary) / 0.12);
}

.topbar-logout {
  @apply h-9;
}

.mobile-drawer-backdrop {
  @apply fixed inset-0 z-[120] bg-slate-950/60 backdrop-blur-[1px];
}

.mobile-drawer {
  @apply relative z-[121] h-full w-[88%] max-w-[360px] border-r border-sidebarActive/60 bg-sidebar/95 px-4 py-4 text-sidebarForeground shadow-[0_20px_40px_rgba(0,0,0,0.36)];
}

.mobile-drawer .topbar-control-wrap {
  @apply z-[122];
}

.mobile-drawer-header {
  @apply flex items-start justify-between gap-2;
}

.mobile-drawer-nav {
  @apply mt-4 grid gap-1.5;
}

.mobile-drawer-nav a {
  @apply rounded-xl px-3 py-2.5 text-sm font-medium text-sidebarMuted transition-all duration-200;
}

.mobile-drawer-nav a:hover {
  @apply bg-sidebarActive/70 text-sidebarForeground;
}

.mobile-drawer-nav a.active {
  @apply bg-sidebarActive text-sidebarForeground shadow-[0_8px_24px_rgba(0,0,0,0.2)];
}

.mobile-drawer-controls {
  @apply mt-4 grid gap-2 border-t border-sidebarActive/60 pt-4;
}

.mobile-drawer .topbar-icon-button {
  @apply w-full justify-between rounded-xl border-sidebarActive/70 bg-sidebarActive/40 px-3 py-2 text-sidebarForeground;
}

.mobile-drawer .topbar-icon-button svg {
  @apply text-sidebarMuted;
}

.mobile-drawer .topbar-dropdown {
  @apply left-0 right-auto z-[130] min-w-[100%] border-sidebarActive/80 bg-sidebar/95;
}

.mobile-drawer .topbar-dropdown-item {
  @apply text-sidebarForeground hover:bg-sidebarActive/70;
}

.mobile-drawer .topbar-dropdown-item.is-active {
  @apply bg-sidebarActive text-sidebarForeground;
}

html.light .mobile-drawer {
  @apply border-border/80 bg-card/95 text-foreground;
}

html.light .mobile-drawer-kicker,
html.light .mobile-drawer-area {
  color: rgb(var(--muted));
}

html.light .mobile-drawer-title {
  color: rgb(var(--foreground));
}

html.light .mobile-drawer-nav a {
  @apply text-muted;
}

html.light .mobile-drawer-nav a:hover,
html.light .mobile-drawer-nav a.active {
  @apply bg-foreground/5 text-foreground shadow-none;
}

html.light .mobile-drawer-controls {
  @apply border-border/70;
}

html.light .mobile-drawer .topbar-icon-button {
  @apply border-border/80 bg-background/80 text-foreground;
}

html.light .mobile-drawer .topbar-icon-button svg {
  @apply text-muted;
}

html.light .mobile-drawer .topbar-dropdown {
  @apply border-border/80 bg-card/95;
}

html.light .mobile-drawer .topbar-dropdown-item {
  @apply text-foreground hover:bg-foreground/5;
}

html.light .mobile-drawer .topbar-dropdown-item.is-active {
  color: rgb(var(--primary));
  background: rgb(var(--primary) / 0.12);
}

.dark .mobile-drawer {
  @apply border-sidebarActive/60 bg-sidebar/95 text-sidebarForeground;
}

.dark .mobile-drawer-kicker,
.dark .mobile-drawer-area {
  color: rgb(var(--sidebar-muted));
}

.dark .mobile-drawer-title {
  color: rgb(var(--sidebar-foreground));
}

.dark .mobile-drawer-nav a {
  @apply text-sidebarMuted;
}

.dark .mobile-drawer-nav a:hover {
  @apply bg-sidebarActive/70 text-sidebarForeground;
}

.dark .mobile-drawer-nav a.active {
  @apply bg-sidebarActive text-sidebarForeground shadow-[0_8px_24px_rgba(0,0,0,0.2)];
}

.dark .mobile-drawer-controls {
  @apply border-sidebarActive/60;
}

.dark .mobile-drawer .topbar-icon-button {
  @apply border-sidebarActive/70 bg-sidebarActive/40 text-sidebarForeground;
}

.dark .mobile-drawer .topbar-icon-button svg {
  @apply text-sidebarMuted;
}

.dark .mobile-drawer .topbar-dropdown {
  @apply border-sidebarActive/80 bg-sidebar/95;
}

.dark .mobile-drawer .topbar-dropdown-item {
  @apply text-sidebarForeground hover:bg-sidebarActive/70;
}

.dark .mobile-drawer .topbar-dropdown-item.is-active {
  @apply bg-sidebarActive text-sidebarForeground;
}

.content {
  @apply grid gap-4;
}

.centered-screen {
  @apply grid min-h-screen place-items-center p-4;
}

.panel {
  @apply rounded-2xl border border-border/80 bg-card/80 p-5 shadow-[0_12px_32px_rgba(18,28,45,0.08)] backdrop-blur;
}

.page-surface {
  @apply relative overflow-hidden rounded-3xl;
}

.page-surface::before {
  content: '';
  position: absolute;
  inset: -20% auto auto -15%;
  width: 300px;
  height: 300px;
  border-radius: 9999px;
  background: radial-gradient(circle, rgb(var(--primary) / 0.1) 0%, transparent 70%);
  pointer-events: none;
}

.page-surface::after {
  content: '';
  position: absolute;
  right: -80px;
  bottom: -120px;
  width: 320px;
  height: 320px;
  border-radius: 9999px;
  background: radial-gradient(circle, rgb(var(--success) / 0.09) 0%, transparent 72%);
  pointer-events: none;
}

.kpi-card {
  @apply relative overflow-hidden rounded-2xl border border-border/70 bg-card/90 p-4 shadow-[0_12px_30px_rgba(10,18,35,0.08)] transition-all duration-200 hover:-translate-y-0.5 hover:shadow-[0_16px_38px_rgba(10,18,35,0.12)];
}

.kpi-card::after {
  content: '';
  position: absolute;
  inset: 0;
  pointer-events: none;
  background: linear-gradient(120deg, transparent 0%, rgb(var(--primary) / 0.06) 100%);
}

.timeline-card {
  @apply rounded-xl border border-border/70 bg-card/75 px-3 py-2.5 transition-colors duration-150 hover:bg-card;
}

.filter-surface {
  @apply rounded-2xl border border-border/70 bg-gradient-to-r from-background/80 via-card/60 to-background/75 p-3;
}

.table-surface {
  @apply overflow-x-auto rounded-2xl border border-border/70 bg-card/60 shadow-[inset_0_1px_0_rgba(255,255,255,0.12)];
}

input[type='date'],
input[type='datetime-local'] {
  color-scheme: light;
}

input[type='date']::-webkit-calendar-picker-indicator,
input[type='datetime-local']::-webkit-calendar-picker-indicator {
  opacity: 0.9;
}

.dark input[type='date'],
.dark input[type='datetime-local'] {
  color-scheme: dark;
}

.dark input[type='date']::-webkit-calendar-picker-indicator,
.dark input[type='datetime-local']::-webkit-calendar-picker-indicator {
  filter: invert(1) brightness(1.2);
  opacity: 0.95;
}

.calendar-tabbar {
  @apply inline-flex flex-wrap gap-2 rounded-2xl border border-border/70 bg-background/65 p-1.5;
}

.calendar-tab {
  @apply rounded-xl px-3 py-1.5 text-sm font-semibold text-muted transition-all duration-150 hover:bg-card hover:text-foreground;
}

.calendar-tab.is-active {
  @apply bg-card text-foreground shadow-sm;
}

.calendar-nav {
  @apply flex flex-wrap items-center justify-between gap-2 rounded-2xl border border-border/70 bg-card/60 p-3;
}

.calendar-grid {
  @apply grid gap-3 lg:grid-cols-[minmax(0,1fr)_300px];
}

.calendar-surface {
  @apply overflow-visible rounded-2xl border border-border/70 bg-card/70 p-2;
}

.calendar-scroll-x {
  @apply overflow-x-auto;
  overflow-y: visible;
}

.calendar-detail {
  @apply rounded-2xl border border-border/70 bg-card/70 p-4;
}

.fc {
  position: relative;
  --fc-border-color: rgb(var(--border) / 0.8);
  --fc-page-bg-color: transparent;
  --fc-neutral-bg-color: rgb(var(--foreground) / 0.04);
  --fc-list-event-hover-bg-color: rgb(var(--foreground) / 0.06);
  --fc-today-bg-color: rgb(var(--primary) / 0.08);
  --fc-event-bg-color: rgb(var(--primary));
  --fc-event-border-color: rgb(var(--primary));
  --fc-event-text-color: #fff;
}

.fc .fc-popover {
  z-index: 160;
}

.mobile-drawer-backdrop .fc .fc-popover,
.mobile-drawer .fc .fc-popover {
  z-index: 160;
}

.fc .fc-col-header-cell-cushion,
.fc .fc-daygrid-day-number,
.fc .fc-timegrid-axis-cushion,
.fc .fc-timegrid-slot-label-cushion {
  @apply text-foreground;
}

.fc .fc-toolbar-title {
  @apply text-sm font-semibold text-foreground;
}

.vertex-event-done {
  --fc-event-bg-color: rgb(var(--success));
  --fc-event-border-color: rgb(var(--success));
}

.vertex-event-cancelled,
.vertex-event-no_show {
  --fc-event-bg-color: rgb(var(--danger));
  --fc-event-border-color: rgb(var(--danger));
}

@media (max-width: 900px) {
  .calendar-grid {
    @apply grid-cols-1;
  }

  .calendar-surface,
  .calendar-scroll-x,
  .calendar-surface .fc,
  .calendar-surface .fc-view-harness,
  .calendar-surface .fc-scroller,
  .calendar-surface .fc-daygrid-body,
  .calendar-surface .fc-daygrid-body-unbalanced {
    overflow-y: visible !important;
  }
}

.fade-in {
  animation: fadeIn 220ms ease-out both;
}

.stagger-in {
  animation: liftIn 320ms ease-out both;
}

@keyframes fadeIn {
  from {
    opacity: 0;
    transform: translateY(4px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

@keyframes liftIn {
  from {
    opacity: 0;
    transform: translateY(10px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

@media (max-width: 900px) {
  .app-shell {
    grid-template-columns: 1fr;
  }

  .sidebar {
    @apply hidden;
  }

  .main {
    @apply px-3 py-3;
  }

  .topbar {
    @apply sticky top-0 z-40 mb-4 rounded-xl px-3 py-2;
  }

  .topbar-leading {
    @apply w-full;
  }

  .mobile-nav-toggle {
    @apply inline-flex;
  }

  .topbar-actions {
    @apply hidden;
  }

  .topbar-segment {
    @apply w-full justify-between;
  }

  .panel {
    @apply rounded-xl p-4;
  }
}

/* Toast slide-in animation */
@keyframes slideInRight {
  from {
    opacity: 0;
    transform: translateX(100%);
  }
  to {
    opacity: 1;
    transform: translateX(0);
  }
}

.toast-in {
  animation: slideInRight 0.3s ease-out;
}
